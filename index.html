<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aplikasi Keuangan</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a; /* slate-900 */
            color: #e2e8f0; /* slate-200 */
        }
        .glassmorphism {
            background: rgba(30, 41, 59, 0.5); /* slate-800 with 50% opacity */
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        .gradient-text {
            background: linear-gradient(to right, #f472b6, #a78bfa); /* pink-400 to violet-400 */
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        /* Custom scrollbar for dark theme */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1e293b; /* slate-800 */
        }
        ::-webkit-scrollbar-thumb {
            background: #475569; /* slate-600 */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #64748b; /* slate-500 */
        }
        .number-input {
            -moz-appearance: textfield;
        }
        .number-input::-webkit-outer-spin-button,
        .number-input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        /* Glow Effect on Hover/Focus */
        .input-glow:focus {
            box-shadow: 0 0 15px rgba(244, 114, 182, 0.5); /* pink-400 glow */
        }
        .card-glow:hover {
            transform: translateY(-5px);
            box-shadow: 0 0 20px rgba(167, 139, 250, 0.3); /* violet-400 glow */
        }
        .spinner {
            border-top-color: transparent;
            width: 16px;
            height: 16px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="min-h-screen">
    
    <!-- Background Glow Effect -->
    <div class="absolute top-0 left-0 w-full h-full overflow-hidden -z-10">
        <div class="absolute top-[-20%] left-[-20%] w-96 h-96 bg-pink-500/20 rounded-full filter blur-3xl opacity-50 animate-pulse"></div>
        <div class="absolute bottom-[-20%] right-[-20%] w-96 h-96 bg-violet-500/20 rounded-full filter blur-3xl opacity-50 animate-pulse animation-delay-4000"></div>
    </div>

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">

        <!-- Header -->
        <header class="mb-8 text-center">
            <h1 class="text-4xl md:text-5xl font-bold gradient-text">Aplikasi Keuangan</h1>
            <p class="text-slate-400 mt-2">Monitor dan kelola keuangan pribadi.</p>
        </header>
        
        <!-- PAGE: DASHBOARD -->
        <div id="dashboard-page">
            <!-- Summary Cards -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="glassmorphism card-glow p-6 rounded-2xl flex items-center space-x-4">
                    <div class="bg-teal-500/10 p-3 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 text-teal-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" /></svg></div>
                    <div><p class="text-slate-400 text-sm">Total Pemasukan</p><p id="total-masuk" class="text-2xl font-semibold text-teal-400">Rp 0</p></div>
                </div>
                <div class="glassmorphism card-glow p-6 rounded-2xl flex items-center space-x-4">
                    <div class="bg-rose-500/10 p-3 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 text-rose-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M20 12H4" /></svg></div>
                    <div><p class="text-slate-400 text-sm">Total Pengeluaran</p><p id="total-keluar" class="text-2xl font-semibold text-rose-400">Rp 0</p></div>
                </div>
                <div class="glassmorphism card-glow p-6 rounded-2xl flex items-center space-x-4">
                    <div class="bg-violet-500/10 p-3 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 text-violet-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2" /></svg></div>
                    <div><p class="text-slate-400 text-sm">Saldo Akhir</p><p id="saldo-akhir" class="text-2xl font-semibold text-violet-400">Rp 0</p></div>
                </div>
            </div>

            <!-- Main Content Section (Form + Table in one panel) -->
            <div class="glassmorphism rounded-2xl p-6 md:p-8">
                <div class="max-w-lg mx-auto">
                    <h2 class="text-xl font-semibold mb-4 text-slate-100 text-center">Tambah Transaksi Baru</h2>
                    <form id="transaction-form" class="space-y-4">
                        <div><label for="deskripsi" class="block text-sm font-medium text-slate-400">Deskripsi</label><input type="text" id="deskripsi" class="input-glow mt-1 block w-full px-3 py-2 bg-slate-900/50 border border-slate-600 rounded-md text-sm shadow-sm placeholder-slate-500 focus:outline-none focus:border-pink-500 focus:ring-1 focus:ring-pink-500 transition" placeholder="Contoh: Gaji Bulanan" required></div>
                        <div><label for="masuk" class="block text-sm font-medium text-slate-400">Masuk (Rp)</label><input type="text" inputmode="numeric" id="masuk" class="input-glow mt-1 block w-full px-3 py-2 bg-slate-900/50 border border-slate-600 rounded-md text-sm shadow-sm placeholder-slate-500 focus:outline-none focus:border-pink-500 focus:ring-1 focus:ring-pink-500 transition" placeholder="0"></div>
                        <div><label for="keluar" class="block text-sm font-medium text-slate-400">Keluar (Rp)</label><input type="text" inputmode="numeric" id="keluar" class="input-glow mt-1 block w-full px-3 py-2 bg-slate-900/50 border border-slate-600 rounded-md text-sm shadow-sm placeholder-slate-500 focus:outline-none focus:border-pink-500 focus:ring-1 focus:ring-pink-500 transition" placeholder="0"></div>
                        <div><label for="pj" class="block text-sm font-medium text-slate-400">Penanggung Jawab (PJ)</label><input type="text" id="pj" class="input-glow mt-1 block w-full px-3 py-2 bg-slate-900/50 border border-slate-600 rounded-md text-sm shadow-sm placeholder-slate-500 focus:outline-none focus:border-pink-500 focus:ring-1 focus:ring-pink-500 transition" placeholder="Nama PJ"></div>
                        <button type="submit" id="submit-button" class="w-full bg-gradient-to-r from-pink-500 to-violet-500 text-white font-semibold py-2.5 px-4 rounded-lg hover:from-pink-600 hover:to-violet-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-900 focus:ring-violet-500 transition duration-200 ease-in-out transform hover:scale-105 flex items-center justify-center"><span id="button-text">Simpan Transaksi</span><div id="button-spinner" class="spinner border-2 border-white rounded-full ml-2 hidden"></div></button>
                    </form>
                </div>
                <hr class="border-slate-700 my-8">
                <div>
                    <div class="flex flex-col sm:flex-row justify-between items-center mb-4">
                        <h2 class="text-xl font-semibold text-slate-100 mb-4 sm:mb-0">Riwayat Transaksi (Lokal)</h2>
                        <button id="view-recap-btn" class="w-full sm:w-auto bg-slate-700 text-slate-300 font-semibold py-2 px-4 rounded-lg hover:bg-slate-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-900 focus:ring-slate-500 transition duration-200 ease-in-out flex items-center justify-center space-x-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M10 2a6 6 0 00-6 6v3.586l-1.707 1.707A1 1 0 003 15v4a1 1 0 001 1h12a1 1 0 001-1v-4a1 1 0 00-.293-.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z" /></svg>
                            <span>Lihat Rekap</span>
                        </button>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left text-slate-400"><thead class="text-xs text-slate-300 uppercase bg-slate-900/30"><tr><th scope="col" class="px-6 py-3">No</th><th scope="col" class="px-6 py-3">Tanggal & Waktu</th><th scope="col" class="px-6 py-3">Deskripsi</th><th scope="col" class="px-6 py-3">Masuk</th><th scope="col" class="px-6 py-3">Keluar</th><th scope="col" class="px-6 py-3">Saldo</th><th scope="col" class="px-6 py-3">PJ</th><th scope="col" class="px-6 py-3 text-center">Aksi</th></tr></thead><tbody id="transaction-table-body"></tbody></table>
                    </div>
                </div>
            </div>
        </div>

        <!-- PAGE: REKAP DARI GOOGLE SHEET -->
        <div id="recap-page" class="hidden">
            <div class="glassmorphism rounded-2xl overflow-hidden">
                <div class="p-6 flex flex-col sm:flex-row justify-between items-start sm:items-center">
                    <h2 class="text-xl font-semibold text-slate-100 mb-4 sm:mb-0">Rekap Transaksi dari Google Sheet</h2>
                    <div class="flex flex-col sm:flex-row sm:space-x-2 w-full sm:w-auto">
                        <button id="download-csv-btn" class="w-full sm:w-auto mb-2 sm:mb-0 bg-teal-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-teal-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-900 focus:ring-teal-500 transition duration-200 ease-in-out flex items-center justify-center space-x-2">
                             <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                            <span>Download CSV</span>
                        </button>
                        <button id="back-to-dashboard-btn" class="w-full sm:w-auto bg-slate-700 text-slate-300 font-semibold py-2 px-4 rounded-lg hover:bg-slate-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-900 focus:ring-slate-500 transition duration-200 ease-in-out flex items-center justify-center space-x-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" /></svg>
                            <span>Kembali</span>
                        </button>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm text-left text-slate-400"><thead class="text-xs text-slate-300 uppercase bg-slate-900/30"><tr><th scope="col" class="px-6 py-3">No</th><th scope="col" class="px-6 py-3">Tanggal & Waktu</th><th scope="col" class="px-6 py-3">Deskripsi</th><th scope="col" class="px-6 py-3">Masuk</th><th scope="col" class="px-6 py-3">Keluar</th><th scope="col" class="px-6 py-3">Saldo</th><th scope="col" class="px-6 py-3">PJ</th></tr></thead><tbody id="recap-table-body"></tbody></table>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwgo-WgFPjTp9y5uWPB4my2cAoFrkDQfc0q9zJJ9l0fO-hXHKXAZqfFoj7Dh8_tEe142w/exec';

            // --- DOM Element References ---
            const transactionForm = document.getElementById('transaction-form');
            const deskripsiInput = document.getElementById('deskripsi');
            const masukInput = document.getElementById('masuk');
            const keluarInput = document.getElementById('keluar');
            const pjInput = document.getElementById('pj');
            const transactionTableBody = document.getElementById('transaction-table-body');
            const totalMasukEl = document.getElementById('total-masuk');
            const totalKeluarEl = document.getElementById('total-keluar');
            const saldoAkhirEl = document.getElementById('saldo-akhir');
            const submitButton = document.getElementById('submit-button');
            const buttonText = document.getElementById('button-text');
            const buttonSpinner = document.getElementById('button-spinner');
            
            // Page and Navigation Elements
            const dashboardPage = document.getElementById('dashboard-page');
            const recapPage = document.getElementById('recap-page');
            const viewRecapBtn = document.getElementById('view-recap-btn');
            const backToDashboardBtn = document.getElementById('back-to-dashboard-btn');
            const recapTableBody = document.getElementById('recap-table-body');
            const downloadCsvBtn = document.getElementById('download-csv-btn');

            // --- State Management ---
            let localTransactions = JSON.parse(localStorage.getItem('transactions_v4')) || [];
            let recapData = [];

            // --- Helper Functions ---
            const formatCurrency = (amount) => new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', minimumFractionDigits: 0, maximumFractionDigits: 0 }).format(amount);
            const formatDate = (dateString) => new Date(dateString).toLocaleDateString('id-ID', { day: '2-digit', month: 'short', year: 'numeric' });
            const formatDateTime = (dateString) => {
                const date = new Date(dateString);
                const options = { day: '2-digit', month: 'short', year: 'numeric', hour: '2-digit', minute: '2-digit', hour12: false };
                return date.toLocaleString('id-ID', options).replace(/\./g, ':').replace(',', ' -');
            };
            const formatNumberWithDots = (numStr) => numStr ? new Intl.NumberFormat('id-ID').format(String(numStr).replace(/\D/g, '')) : '';
            const parseFormattedNumber = (fmtStr) => fmtStr ? parseFloat(String(fmtStr).replace(/\./g, '')) || 0 : 0;
            const capitalizeWords = (str) => str ? str.toLowerCase().split(' ').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ') : '';

            // --- Page Navigation & Modal Logic ---
            const showDashboard = () => { dashboardPage.classList.remove('hidden'); recapPage.classList.add('hidden'); };
            const showRecap = () => { dashboardPage.classList.add('hidden'); recapPage.classList.remove('hidden'); fetchTransactionsFromSheet(); };

            // --- Core Application Logic ---
            const renderLocalTransactions = () => {
                transactionTableBody.innerHTML = '';
                let totalMasuk = 0, totalKeluar = 0, currentSaldo = 0;
                if (localTransactions.length === 0) {
                    transactionTableBody.innerHTML = `<tr><td colspan="8" class="text-center py-10 text-slate-500">Belum ada transaksi lokal.</td></tr>`;
                } else {
                    const sorted = [...localTransactions].sort((a, b) => new Date(a.date) - new Date(b.date));
                    sorted.forEach((trx, index) => {
                        const masuk = trx.type === 'masuk' ? trx.amount : 0;
                        const keluar = trx.type === 'keluar' ? trx.amount : 0;
                        totalMasuk += masuk; totalKeluar += keluar; currentSaldo += (masuk - keluar);
                        const row = document.createElement('tr');
                        row.className = 'border-b border-slate-700 hover:bg-slate-800/60';
                        row.innerHTML = `
                            <td class="px-6 py-4">${index + 1}</td> <td class="px-6 py-4">${formatDateTime(trx.date)}</td>
                            <td class="px-6 py-4 font-medium text-slate-100">${trx.deskripsi}</td>
                            <td class="px-6 py-4 text-teal-400 font-semibold">${masuk > 0 ? formatCurrency(masuk) : '-'}</td>
                            <td class="px-6 py-4 text-rose-400 font-semibold">${keluar > 0 ? formatCurrency(keluar) : '-'}</td>
                            <td class="px-6 py-4 font-bold ${currentSaldo >= 0 ? 'text-violet-400' : 'text-rose-400'}">${formatCurrency(currentSaldo)}</td>
                            <td class="px-6 py-4">${trx.pj || '-'}</td>
                            <td class="px-6 py-4 text-center"><button data-id="${trx.id}" class="delete-btn text-slate-500 hover:text-rose-500"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg></button></td>`;
                        transactionTableBody.appendChild(row);
                    });
                }
                totalMasukEl.textContent = formatCurrency(totalMasuk);
                totalKeluarEl.textContent = formatCurrency(totalKeluar);
                saldoAkhirEl.textContent = formatCurrency(totalMasuk - totalKeluar);
            };

            const saveLocalTransactions = () => localStorage.setItem('transactions_v4', JSON.stringify(localTransactions));
            
            const addTransaction = async (e) => {
                e.preventDefault();
                const deskripsi = deskripsiInput.value.trim();
                const masuk = parseFormattedNumber(masukInput.value);
                const keluar = parseFormattedNumber(keluarInput.value);
                const pj = pjInput.value.trim();

                if (!deskripsi || (masuk === 0 && keluar === 0)) return alert('Deskripsi dan salah satu nominal harus diisi.');
                if (masuk > 0 && keluar > 0) return alert('Hanya satu dari Masuk atau Keluar yang boleh diisi.');

                submitButton.disabled = true; buttonText.textContent = 'Menyimpan...'; buttonSpinner.classList.remove('hidden');
                const newTransaction = { id: Date.now(), date: new Date().toISOString(), deskripsi, amount: masuk > 0 ? masuk : keluar, type: masuk > 0 ? 'masuk' : 'keluar', pj };
                localTransactions.push(newTransaction);
                saveLocalTransactions();
                renderLocalTransactions();
                
                const sheetData = { tanggal: formatDateTime(newTransaction.date), deskripsi, masuk, keluar, pj };
                try {
                    await fetch(GOOGLE_SCRIPT_URL, { method: 'POST', body: JSON.stringify({ action: 'addTransaction', data: sheetData }), mode: 'no-cors' });
                    console.log('Berhasil mengirim data ke Google Sheet.');
                } catch (error) {
                    console.error('Gagal mengirim data ke Google Sheet:', error);
                    alert('Gagal menyimpan data ke Google Sheet.');
                } finally {
                    transactionForm.reset(); deskripsiInput.focus();
                    submitButton.disabled = false; buttonText.textContent = 'Simpan Transaksi'; buttonSpinner.classList.add('hidden');
                }
            };

            const fetchTransactionsFromSheet = async () => {
                recapTableBody.innerHTML = `<tr><td colspan="7" class="text-center py-10 text-slate-500">Memuat data...</td></tr>`;
                try {
                    const response = await fetch(GOOGLE_SCRIPT_URL, { method: 'POST', body: JSON.stringify({ action: 'getTransactions' }), redirect: "follow" });
                    const result = await response.json();
                    if (result.result !== 'success') throw new Error(result.message);
                    
                    recapData = result.data;
                    recapTableBody.innerHTML = '';
                    if (recapData.length === 0) {
                       recapTableBody.innerHTML = `<tr><td colspan="7" class="text-center py-10 text-slate-500">Tidak ada data.</td></tr>`;
                       return;
                    }

                    let recapSaldo = 0;
                    recapData.forEach((item, index) => {
                        const masuk = parseFloat(item.masuk) || 0;
                        const keluar = parseFloat(item.keluar) || 0;
                        recapSaldo += (masuk - keluar);
                        const row = document.createElement('tr');
                        row.className = 'border-b border-slate-700';
                        row.innerHTML = `
                            <td class="px-6 py-4">${index + 1}</td> <td class="px-6 py-4">${formatDateTime(item.timestamp)}</td>
                            <td class="px-6 py-4 font-medium text-slate-100">${item.deskripsi}</td>
                            <td class="px-6 py-4 text-teal-400 font-semibold">${masuk > 0 ? formatCurrency(masuk) : '-'}</td>
                            <td class="px-6 py-4 text-rose-400 font-semibold">${keluar > 0 ? formatCurrency(keluar) : '-'}</td>
                            <td class="px-6 py-4 font-bold ${recapSaldo >= 0 ? 'text-violet-400' : 'text-rose-400'}">${formatCurrency(recapSaldo)}</td>
                            <td class="px-6 py-4">${item.pj || '-'}</td>`;
                        recapTableBody.appendChild(row);
                    });
                } catch (error) {
                    console.error('Gagal mengambil data:', error);
                    recapTableBody.innerHTML = `<tr><td colspan="7" class="text-center py-10 text-red-400">Gagal memuat data.</td></tr>`;
                }
            };
            
            const downloadRecapAsCSV = () => {
                if (recapData.length === 0) return alert('Tidak ada data untuk di-download.');
                const headers = ["No", "Tanggal & Waktu", "Deskripsi", "Masuk", "Keluar", "Saldo", "PJ"];
                let csvContent = headers.join(",") + "\r\n";
                let saldo = 0;
                recapData.forEach((item, index) => {
                    const masuk = parseFloat(item.masuk) || 0;
                    const keluar = parseFloat(item.keluar) || 0;
                    saldo += (masuk - keluar);
                    const deskripsi = `"${String(item.deskripsi || '').replace(/"/g, '""')}"`;
                    const pj = `"${String(item.pj || '').replace(/"/g, '""')}"`;
                    const row = [index + 1, `"${formatDateTime(item.timestamp)}"`, deskripsi, masuk, keluar, saldo, pj];
                    csvContent += row.join(",") + "\r\n";
                });
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement("a");
                const url = URL.createObjectURL(blob);
                link.setAttribute("href", url);
                link.setAttribute("download", "rekap_keuangan.csv");
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            };

            const deleteLocalTransaction = (id) => {
                if (confirm('Hapus transaksi ini dari riwayat lokal? (Tidak akan menghapus data di Google Sheet)')) {
                    localTransactions = localTransactions.filter(trx => trx.id != id);
                    saveLocalTransactions();
                    renderLocalTransactions();
                }
            };

            // --- Event Listeners ---
            transactionForm.addEventListener('submit', addTransaction);
            transactionTableBody.addEventListener('click', (e) => {
                const btn = e.target.closest('.delete-btn');
                if (btn) deleteLocalTransaction(btn.dataset.id);
            });
            
            masukInput.addEventListener('input', (e) => e.target.value = formatNumberWithDots(e.target.value));
            keluarInput.addEventListener('input', (e) => e.target.value = formatNumberWithDots(e.target.value));
            deskripsiInput.addEventListener('input', (e) => e.target.value = capitalizeWords(e.target.value));
            pjInput.addEventListener('input', (e) => e.target.value = capitalizeWords(e.target.value));

            viewRecapBtn.addEventListener('click', showRecap);
            backToDashboardBtn.addEventListener('click', showDashboard);
            downloadCsvBtn.addEventListener('click', downloadRecapAsCSV);

            // Initial render on page load
            renderLocalTransactions();
        });
    </script>
</body>
</html>
